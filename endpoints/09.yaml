name: 'OAuth Authentication'
description: ''
endpoints:
  -
    custom: []
    httpMethods:
      - GET
    uri: 'oauth/{provider}/redirect'
    metadata:
      custom: []
      groupName: 'OAuth Authentication'
      groupDescription: ''
      subgroup: ''
      subgroupDescription: ''
      title: 'Get OAuth redirect URL'
      description: |-
        Initiates OAuth flow by redirecting to the provider's authorization page.
        Works for both login/register and account linking scenarios.

        - If user is NOT authenticated: will login/register after callback
        - If user IS authenticated: will link social account after callback
      authenticated: false
      deprecated: false
    headers:
      Content-Type: application/json
      Accept: application/json
    urlParameters:
      provider:
        custom: []
        name: provider
        description: 'The OAuth provider (google, facebook).'
        required: true
        example: google
        type: string
        enumValues: []
        exampleWasSpecified: true
        nullable: false
        deprecated: false
    cleanUrlParameters:
      provider: google
    queryParameters: []
    cleanQueryParameters: []
    bodyParameters: []
    cleanBodyParameters: []
    fileParameters: []
    responses:
      -
        custom: []
        status: 301
        content: ''
        headers: []
        description: "Redirect to provider's OAuth authorization page"
      -
        custom: []
        status: 422
        content: |-
          {
            "message": "Invalid OAuth provider.",
            "errors": {
              "provider": ["Invalid OAuth provider."]
            }
          }
        headers: []
        description: 'Invalid provider'
      -
        custom: []
        status: 422
        content: |-
          {
            "message": "This OAuth provider is not enabled.",
            "errors": {
              "provider": ["This OAuth provider is not enabled."]
            }
          }
        headers: []
        description: 'Provider not enabled'
      -
        custom: []
        status: 422
        content: |-
          {
            "message": "This OAuth provider is not configured.",
            "errors": {
              "provider": ["This OAuth provider is not configured."]
            }
          }
        headers: []
        description: 'Provider not configured'
      -
        custom: []
        status: 422
        content: '{"message":"This OAuth provider is not enabled.","errors":{"provider":["This OAuth provider is not enabled."]}}'
        headers:
          cache-control: 'no-cache, private'
          content-type: application/json
          set-cookie: 'XSRF-TOKEN=eyJpdiI6IkxDVDBEcEFMZ3gvSFhqWmhURmxaY2c9PSIsInZhbHVlIjoiSDhETW40cU9EaUk4QlZIbTJ2Y0xDVk1jem1hMVRTaEFJU284NkVJT3R3TFdyRjlIV3p0QXdGTmwrUXhlZm03cXlvcHk1SVhyOW1la05HeVNlRSs4UUlyWjN4WDNCdEl0WjZpKzdLKzFaTWxmSVpYS2kxbVNDZ1pHa1hBN1h2aWciLCJtYWMiOiJiZGYxNzY2NTAzMjc3MjQ1Mjc5Y2Y3MDYzNTZjMjMzNTBjNGE3YzBjOTYxNmQ3YjBmMzdjNmE3Y2ZhNzFiNGM5IiwidGFnIjoiIn0%3D; expires=Tue, 27 Jan 2026 10:45:44 GMT; Max-Age=7200; path=/; samesite=lax; nexora-session=eyJpdiI6Ikg4eVJDY1FYVmRGOGhmLzNmZk9jK0E9PSIsInZhbHVlIjoidDY4R3h4MWpQakNMOElXVEJqUXpWZ1pqOVNGUWZpdWRiVU9SUytER0M1VlVhTFQ4WGRDS2hSSzFieUZqWTRPSFZMQ0JWYkVsckhrWWxsNlNRMVpEcmp5bDZQNG5RTGh5emRWUHlXemEwQjM0VWI0WmpxcksxZkNETG5QWnlLbHciLCJtYWMiOiJkZTAyYWJhNGU0NmRhN2NlYzBiYzU4ZWNjYWEzM2U4Mjg1MDQ2M2YyZjhiZmE2ZmJiZWQyNjQ1ODU3ZTg0MDhmIiwidGFnIjoiIn0%3D; expires=Tue, 27 Jan 2026 10:45:44 GMT; Max-Age=7200; path=/; httponly; samesite=lax'
        description: null
      -
        custom: []
        status: 429
        content: |-
          {
            "message": "Too many login attempts. Please try again in 60 seconds.",
            "errors": {
              "email": ["Too many login attempts. Please try again in 60 seconds."]
            }
          }
        headers: []
        description: 'Too many requests'
    responseFields: []
    auth: []
    controller: null
    method: null
    route: null
  -
    custom: []
    httpMethods:
      - GET
    uri: 'oauth/{provider}/callback'
    metadata:
      custom: []
      groupName: 'OAuth Authentication'
      groupDescription: ''
      subgroup: ''
      subgroupDescription: ''
      title: 'Handle OAuth callback'
      description: |-
        Processes the OAuth callback from the provider.
        Automatically detects whether to login/register or link account.

        **Login/Register scenario (user not authenticated):**
        - Finds user by social account or email
        - Creates new user if not found
        - Logs user in and generates session
        - Redirects to frontend callback URL

        **Link account scenario (user authenticated):**
        - Validates social account is not linked to another user
        - Links social account to current user
        - Keeps current session
        - Redirects to frontend callback URL
      authenticated: false
      deprecated: false
    headers:
      Content-Type: application/json
      Accept: application/json
    urlParameters:
      provider:
        custom: []
        name: provider
        description: 'The OAuth provider (google, facebook).'
        required: true
        example: google
        type: string
        enumValues: []
        exampleWasSpecified: true
        nullable: false
        deprecated: false
    cleanUrlParameters:
      provider: google
    queryParameters: []
    cleanQueryParameters: []
    bodyParameters: []
    cleanBodyParameters: []
    fileParameters: []
    responses:
      -
        custom: []
        status: 302
        content: ''
        headers: []
        description: 'Success - redirects to frontend'
      -
        custom: []
        status: 302
        content: |-
          {
            "redirects_to": "frontend_callback_url?errors[provider]=This account is already linked to another user."
          }
        headers: []
        description: 'Account already linked to another user'
      -
        custom: []
        status: 302
        content: |-
          <!DOCTYPE html>
          <html>
              <head>
                  <meta charset="UTF-8" />
                  <meta http-equiv="refresh" content="0;url='http://localhost:8000'" />

                  <title>Redirecting to http://localhost:8000</title>
              </head>
              <body>
                  Redirecting to <a href="http://localhost:8000">http://localhost:8000</a>.
              </body>
          </html>
        headers:
          cache-control: 'no-cache, private'
          location: 'http://localhost:8000'
          content-type: 'text/html; charset=utf-8'
          set-cookie: 'XSRF-TOKEN=eyJpdiI6Ii96UEpiaGVKZHFNYWJiaU5NYmtkTXc9PSIsInZhbHVlIjoiSjNiYXZCZDJoVHRpZ2N2ckZyOXNmaGFLRHZJQmdZYUttbENiRlh3MnhzL05JNGJBL0ttcDk2aVorc3RDbyt0dzNYQzFtTHBGbVJwUTZMcDhkRTNLa1ErS1dpWU9HZWdBblFxdTNMSFFUMlpkMVA4YjlTbXAxb2VCZHhpeVlrL1EiLCJtYWMiOiJhNjBmMTc5OGRiYmU5YzFkMGU4YjJkOTQ3YWJhNzVmMTNkMzYyYmYxMGQyMjI0ZjU0MGRkZGJhYWI2MjMzYjI0IiwidGFnIjoiIn0%3D; expires=Tue, 27 Jan 2026 10:45:44 GMT; Max-Age=7200; path=/; samesite=lax; nexora-session=eyJpdiI6InI0RWptU3p6NEhwUkUvM0JFWVk1ekE9PSIsInZhbHVlIjoiVlI3ZWFNZExqZ25TdVcwNW9saW9TYUFYc1NPb2ZjdTVhME0zMDhyTVhINmVsUEpGYkJnaC9QVTlZUHUyNHJhRll2ZWN2elIxczIwZ1hmQXU0YVJQcVBnM0VFRy9qSUNEZTczOFVpNXpWdnpVOFRiWTJFek1Wd3BEc0ppblpnQnEiLCJtYWMiOiIyMjk1ODg2NjBhNWMwNTU5NzhiMTg3YjEwYzk4N2Q4NGQ3Mzk5M2Y2Mjg5ZmZlOTgzOWVkYjNlNzMyNTE1ZGRlIiwidGFnIjoiIn0%3D; expires=Tue, 27 Jan 2026 10:45:44 GMT; Max-Age=7200; path=/; httponly; samesite=lax'
        description: null
      -
        custom: []
        status: 422
        content: |-
          {
            "message": "This account is already linked to another user.",
            "errors": {
              "provider": ["This account is already linked to another user."]
            }
          }
        headers: []
        description: 'Validation error (if no frontend callback URL)'
      -
        custom: []
        status: 429
        content: |-
          {
            "message": "Too many login attempts. Please try again in 60 seconds.",
            "errors": {
              "email": ["Too many login attempts. Please try again in 60 seconds."]
            }
          }
        headers: []
        description: 'Too many requests'
    responseFields: []
    auth: []
    controller: null
    method: null
    route: null
